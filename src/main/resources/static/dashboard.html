<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>主页面</title>
  <style>
    /* 样式用于将页面内容垂直居中 */
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    /* 其他样式 */
  </style>
</head>
<body>
<h1>欢欢丹姐银行欢迎您的光临</h1>
<h1>欢迎尊贵的用户 <span id="userName"></span>!</h1>

<p>Your balance: $<span id="balance">-</span></p>
<button id="refreshBalance">刷新余额</button>

<h2>存款</h2>
<input type="number" id="depositAmount" placeholder="请输入您的存款金额"><br>
<button id="depositButton">存款</button>

<h2>取款</h2>
<input type="number" id="withdrawAmount" placeholder="请输入您的取款金额"><br>
<button id="withdrawButton">取款</button>

<script>
  // Fetch balance and update UI

  // 获取用户名并展示
  const urlParams = new URLSearchParams(window.location.search);
  const username = urlParams.get('userName');
  document.getElementById("userName").textContent = username;

  function refreshBalance() {
    fetch('/getBalance?userName=${userName}')
            .then(response => response.json())
            .then(data => {
              document.getElementById("balance").textContent = data.balance;
            });
  }

  // 刷新余额
  document.getElementById("checkBalance").addEventListener("click", function() {
    refreshBalance();
  });

  // Deposit button click event
  document.getElementById("depositButton").addEventListener("click", function() {
    const depositAmount = parseFloat(document.getElementById("depositAmount").value);
    fetch('/deposit', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ amount: depositAmount })
    })
            .then(response => response.json())
            .then(data => {
              alert(data.message);
              fetchBalance();
            });
  });

  // Withdraw button click event
  document.getElementById("withdrawButton").addEventListener("click", function() {
    const withdrawAmount = parseFloat(document.getElementById("withdrawAmount").value);
    fetch('/withdraw', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ amount: withdrawAmount })
    })
            .then(response => response.json())
            .then(data => {
              alert(data.message);
              fetchBalance();
            });
  });

  // Fetch balance when the page loads
  refreshBalance();

</script>
</body>
</html>
